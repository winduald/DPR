

python dense_retriever.py --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --ctx_file  /checkpoint/xiaojianwu/DPR/data/wikipedia_split/psgs_w100.tsv --qa_file /checkpoint/xiaojianwu/DPR/data/retriever/qas/nq-test.csv --encoded_ctx_file "/checkpoint/xiaojianwu/DPR/data/encoded/nq/*" --out_file /checkpoint/xiaojianwu/DPR/data/test_results --n-docs 10 --save_or_load_index


python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_bs_test.json


python3 -m pdb train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_bs_test.json --output_dir /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/test --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256

python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_bs_test.json --train_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_bs_train.json

python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/semeval --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_bs_test.json


 python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_test.json --checkpoint_file_name run_20 --num_train_epochs 8 --share_encoder --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/doc_share/run_0 --share_encoder --which_encoder_to_load c --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/doc_share/run_0 --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp



python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_train.json --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --checkpoint_file_name run_20 --num_train_epochs 20 --share_encoder --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/bert_share/run_0
python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_test.json --checkpoint_file_name run_20 --num_train_epochs 20 --share_encoder --which_encoder_to_load q --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/question_share/run_0 --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp
python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_test.json --checkpoint_file_name run_20 --num_train_epochs 20 --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/no_share/run_0 --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp
python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_test.json --checkpoint_file_name run_20 --num_train_epochs 20 --share_encoder --which_encoder_to_load c --hard_negatives 30 --batch_size 2 --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/doc_share/run_0 --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp



python train_dense_encoder.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --sequence_length 256 --dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json --share_encoder --which_encoder_to_load c --hard_negatives 30 --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu/doc_share --model_file /checkpoint/xiaojianwu/DPR/results/askubuntu/doc_share/run_0/run_60_b3.99.79



python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json


python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json


#eval
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json

#train
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_train_file 


#train qa
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu/qa --model_file /checkpoint/xiaojianwu/DPR/results/askubuntu/qa/dpr_biencoder.7.2138 --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_merged.json --num_train_epochs 8

#eval qa
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu/qa --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/results/askubuntu/qa/dpr_biencoder.9.2138

#qqs with qa pretrained
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/qa_qqs --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --qa_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_merged.json --question_sim_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --num_train_epochs 10


#srun prefix
srun --job-name tmp --output ./train.log --error ./train.stderr --gres gpu:volta:1 --nodes 1 --ntasks-per-node 1 --cpus-per-task 8 -C volta32gb --partition learnfair --time 4000 --mem-per-cpu 7G


#srun train
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/qa_qqs --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --qa_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_merged.json --question_sim_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --num_train_epochs 12 --num_iterations_per_epoch 4000 --checkpoint_file_name all_qa

srun --job-name tmp --output ./train.log --error ./train.stderr --gres gpu:volta:1 --nodes 1 --ntasks-per-node 1 --cpus-per-task 8 -C volta32gb --partition learnfair --time 4000 --mem-per-cpu 7G python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/semeval/qa_qqs --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_test.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --qa_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_qa_q1bs_all.json --question_sim_train_file /checkpoint/xiaojianwu/data/semeval/dpr/semeval_q1s_q2s_train.json --num_train_epochs 12 --num_iterations_per_epoch 4000 --checkpoint_file_name all_qa &

#askubuntu
srun --job-name tmp --output ./train.log --error ./train.stderr --gres gpu:volta:1 --nodes 1 --ntasks-per-node 1 --cpus-per-task 8 -C volta32gb --partition learnfair --time 4000 --mem-per-cpu 7G python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu/qa_qqs --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_qa_qbs_10_10_1000000_test_shard_30_combined_modified.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp --qa_train_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_qa_qbs_10_10_1000000_train_shard_30_combined_modified.json --question_sim_train_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_train.json --num_train_epochs 12 --num_iterations_per_epoch 65000 --num_qa_examples_per_qqs_example 3 --checkpoint_file_name all_qa &

#eval
python train_dense_encoder_multi_task.py --encoder_model_type hf_bert --pretrained_model_cfg bert-base-uncased --output_dir /checkpoint/xiaojianwu/DPR/results/askubuntu/qa_qqs --sequence_length 256 --question_sim_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json --qa_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_qa_qbs_10_10_1000000_test_shard_30_combined_modified.json --answer_sim_dev_file /checkpoint/xiaojianwu/data/askubuntu/dpr/askubuntu_q1bs_q2bs_test.json --model_file /checkpoint/xiaojianwu/DPR/checkpoint/retriever/single/nq/bert-base-encoder.cp